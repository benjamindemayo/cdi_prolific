study_name,
subject_id,
sex,
age,
ethnicity,
maternal_ed,
produced
),
ws_ses %>%
select(
study_name,
subject_id,
sex,
age,
ethnicity,
maternal_ed,
produced
)
)
#Prepare the gender plots and numbers for the caption.
wg_gender_ses <-
wg_ses %>%
select(age, produced, sex)
ws_gender_ses <-
ws_ses %>%
select(age, produced, sex)
all_d_gender_ses <-
bind_rows(ws_gender_ses, wg_gender_ses)
all_d_gender_count_ses <- all_d_gender_ses %>% count(sex)
n_females_ses <- all_d_gender_count_ses %>% slice(1) %>% pull(2)
n_males_ses <- all_d_gender_count_ses %>% slice(2) %>% pull(2)
n_other_ses <- all_d_gender_count_ses %>% slice(3) %>% pull(2)
all_gender_n_ses <- all_d_gender_count_ses$n %>% sum()
gender_caption_ses <- str_c(
"Individual children’s vocabulary production scores from Dataset 2 (recent data collection efforts) plotted by children’s age and gender (both WG and WS, N = ",
formatC(all_gender_n_ses - n_other_ses, big.mark = ",", big.interval = 3),
", with ",
formatC(n_females_ses, big.mark = ",", big.interval = 3),
" girls). Lines are best linear fits with associated 95% confidence intervals. Children with a different or no reported gender (N = ",
n_other_ses,
") are omitted here."
)
genderses_v1 <-
all_d_gender_ses %>%
filter(sex != "Other") %>%
ggplot(aes(age, produced, color = sex)) +
ggthemes::theme_few() +
geom_jitter(alpha = 0.6, width = 0.225, size = 2) +
geom_smooth(method = "lm") +
coord_cartesian(ylim = c(0, 686)) +
labs(
x = "Age in months",
y = "Total words produced",
color = "Child gender"
) +
scale_color_viridis_d(begin = .3, end = .8, option = "inferno")
genderses_v1
genderses_v1 <-
all_d_gender_ses %>%
filter(sex != "Other") %>%
ggplot(aes(age, produced, color = sex)) +
ggthemes::theme_few() +
geom_jitter(alpha = 0.6, width = 0.225, size = 2) +
geom_smooth(method = "lm") +
coord_cartesian(ylim = c(0, 686)) +
labs(
x = "Age in months",
y = "Total words produced",
color = "Child gender"
) +
scale_color_viridis_d(begin = 0.25, end = 0.75)
genderses_v1
momed_ses_v1 <-
momed_ses_df %>%
filter(
age <= 30
) %>%
ggplot(aes(age, produced, color = highschool)) +
geom_jitter(alpha = 0.6, width = 0.225, size = 2) +
geom_smooth(method = "lm") +
labs(
x = "Age in months",
y = "Words produced"
) +
ggthemes::theme_few() +
theme(legend.title = element_blank()) +
scale_color_viridis_d(option = "inferno", begin = 0.3, end = 0.8)
#Make tibble to show vocab scores by primary caregiver education
momed_ses_df <-
demographics_df_ses %>%
mutate(highschool = case_when(
maternal_ed == "Some high school or less" ~ "High school",
maternal_ed == "High school diploma" ~ "High school",
maternal_ed == "Some college education" ~ "College",
maternal_ed == "College diploma or more" ~ "College"
))
#Caption for momed plot
momed_caption_ses <-
str_c(
"Individual children's vocabulary production scores from Dataset 2 (recent data collection efforts) plotted by age and level of primary caregiver education, binned into those with a high school diploma or less education and those with some college education or a college diploma (N = ",
nrow(wg_ses) + nrow(ws_ses),
"). Lines show best linear fits and associated 95% confidence intervals."
)
momed_ses_v1 <-
momed_ses_df %>%
filter(
age <= 30
) %>%
ggplot(aes(age, produced, color = highschool)) +
geom_jitter(alpha = 0.6, width = 0.225, size = 2) +
geom_smooth(method = "lm") +
labs(
x = "Age in months",
y = "Words produced"
) +
ggthemes::theme_few() +
theme(legend.title = element_blank()) +
scale_color_viridis_d(option = "inferno", begin = 0.3, end = 0.8)
momed_ses_v1
momed_ses_v1 <-
momed_ses_df %>%
filter(
age <= 30
) %>%
ggplot(aes(age, produced, color = highschool)) +
geom_jitter(alpha = 0.6, width = 0.225, size = 2) +
geom_smooth(method = "lm") +
labs(
x = "Age in months",
y = "Words produced"
) +
ggthemes::theme_few() +
theme(legend.title = element_blank()) +
scale_color_viridis_d(option = "inferno", begin = 0.3, end = 0.8) +
coord_cartesian(ylim = c(0, 600))
momed_ses_v1
wg_med_plot <-
wg_filtered %>%
mutate(
maternal_ed = fct_recode(
maternal_ed,
"High school diploma or less" = "High school diploma",
"High school diploma or less" = "Some high school or less"
)
) %>%
filter(!is.na(maternal_ed) & maternal_ed != "Not reported") %>%
select(
age,
`Words Understood` = understood,
`Words Produced` = produced,
maternal_ed
) %>%
pivot_longer(
cols = c("Words Understood", "Words Produced"),
names_to = "measure",
values_to = "words"
) %>%
group_by(age, maternal_ed, measure) %>%
summarize(
median = median(words, na.rm = TRUE),
first_quartile = quantile(words, probs = 0.25, na.rm = TRUE),
third_quartile = quantile(words, probs = 0.75, na.rm = TRUE)
) %>%
ggplot(aes(age, median, color = maternal_ed)) +
facet_grid(~measure) +
geom_point(
position = position_dodge(width = 0.7),
size = 3
) +
geom_linerange(
aes(ymin = first_quartile, ymax = third_quartile),
position = position_dodge(width = 0.7),
size = 0.8
) +
scale_x_continuous(breaks = seq(from = 8, to = 18, by = 2)) +
coord_cartesian(ylim = c(0, 390)) +
ggthemes::theme_few() +
labs(
x = "Age in months",
y = "Nmber of words"
) +
theme(
axis.text = element_text(size = 15),
axis.title = element_text(size = 15),
legend.text = element_text(size = 15),
strip.text = element_text(size = 15),
legend.position = "bottom",
legend.title = element_blank()
) +
scale_color_viridis_c(option = "inferno", begin = 0.3, end = 0.8)
ggsave(
"median_plot.png",
plot = wg_med_plot,
path = fig_directory,
width = 12,
height = 8
)
wg_med_plot <-
wg_filtered %>%
mutate(
maternal_ed = fct_recode(
maternal_ed,
"High school diploma or less" = "High school diploma",
"High school diploma or less" = "Some high school or less"
)
) %>%
filter(!is.na(maternal_ed) & maternal_ed != "Not reported") %>%
select(
age,
`Words Understood` = understood,
`Words Produced` = produced,
maternal_ed
) %>%
pivot_longer(
cols = c("Words Understood", "Words Produced"),
names_to = "measure",
values_to = "words"
) %>%
group_by(age, maternal_ed, measure) %>%
summarize(
median = median(words, na.rm = TRUE),
first_quartile = quantile(words, probs = 0.25, na.rm = TRUE),
third_quartile = quantile(words, probs = 0.75, na.rm = TRUE)
) %>%
ggplot(aes(age, median, color = maternal_ed)) +
facet_grid(~measure) +
geom_point(
position = position_dodge(width = 0.7),
size = 3
) +
geom_linerange(
aes(ymin = first_quartile, ymax = third_quartile),
position = position_dodge(width = 0.7),
size = 0.8
) +
scale_x_continuous(breaks = seq(from = 8, to = 18, by = 2)) +
coord_cartesian(ylim = c(0, 390)) +
ggthemes::theme_few() +
labs(
x = "Age in months",
y = "Nmber of words"
) +
theme(
axis.text = element_text(size = 15),
axis.title = element_text(size = 15),
legend.text = element_text(size = 15),
strip.text = element_text(size = 15),
legend.position = "bottom",
legend.title = element_blank()
) +
scale_color_viridis_d(option = "inferno", begin = 0.3, end = 0.8)
ggsave(
"median_plot.png",
plot = wg_med_plot,
path = fig_directory,
width = 12,
height = 8
)
ws_med_plot <-
ws_filtered %>%
mutate(
maternal_ed = fct_recode(
maternal_ed,
"High school diploma or less" = "High school diploma",
"High school diploma or less" = "Some high school or less"
)
) %>%
filter(!is.na(maternal_ed) & maternal_ed != "Not reported") %>%
select(
age,
produced,
maternal_ed
) %>%
group_by(age, maternal_ed) %>%
summarize(
median = median(produced, na.rm = TRUE),
first_quartile = quantile(produced, probs = 0.25, na.rm = TRUE),
third_quartile = quantile(produced, probs = 0.75, na.rm = TRUE)
) %>%
ggplot(aes(age, median, color = maternal_ed)) +
geom_point(
position = position_dodge(width = 0.7),
size = 3
) +
geom_linerange(
aes(ymin = first_quartile, ymax = third_quartile),
position = position_dodge(width = 0.7),
size = 0.8
) +
scale_x_continuous(breaks = seq(from = 16, to = 30, by = 2)) +
coord_cartesian(ylim = c(0, 700)) +
ggthemes::theme_few() +
labs(
x = "Age in months",
y = "Number of words produced"
) +
theme(
axis.text = element_text(size = 15),
axis.title = element_text(size = 15),
legend.text = element_text(size = 15),
strip.text = element_text(size = 15),
legend.position = "bottom",
legend.title = element_blank()
) +
scale_color_viridis_d(option = "inferno", begin = 0.3, end = 0.8)
ggsave(
"wsmedplot.png",
plot = ws_med_plot,
path = fig_directory,
width = 10,
height = 7
)
?across
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(.cols = everything(), .fns = round(digits = 3)))
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(.cols = everything(), .fns = ~ round(digits = 3)))
comp_table <-
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(.cols = everything(), .fns = ~ round(cur_column(), digits = 3)))
comp_table <-
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(.fns = ~ round(cur_column(), digits = 3)))
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(everything(), as.character))
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome)
ses_wg_lm_comp %>%
tidy()
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames)
rownames <-
c(
"Intercept",
"Age",
"Caregiver education: Some college",
"Caregiver education: High school or less",
"Age * Caregiver education: Some college",
"Age * Caregiver education: High school or less"
)
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(everything(), ~ round(digits = 2)))
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(everything(), ~ round(cur_column(), digits = 2)))
ses_wg_lm_comp %>%
tidy() %>%
mutate(term = rownames) %>%
select(-outcome) %>%
mutate(across(everything(), as.character))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(everything(), ~ round(cur_column(), digits = 2))) %>%
mutate(term = rownames) %>%
select(-outcome)
ses_wg_lm_comp %>%
tidy()
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(everything(), round(cur_column(), digits = 2)))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(everything(), round))
ses_wg_lm_comp %>%
tidy()
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(
.cols = !term,
.fns = round
))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = round
))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = ~ round(cur_column(), digits = 3)
))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = ~ round(., digits = 3)
))
ses_wg_lm_comp %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = ~ round(., digits = 3)
)) %>%
mutate(term = rownames) %>%
select(-outcome) %>%
kbl(
booktabs = TRUE,
linesep = "",
caption = "Regression output for WG comprehension measure."
) %>%
kable_styling(
position = "center",
latex_options = "scale_down"
)
ses_wg_lm_prod %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = ~ round(., digits = 3)
)) %>%
mutate(term = rownames) %>%
select(-outcome) %>%
kbl(
booktabs = TRUE,
linesep = "",
caption = "Regression output for WG production measure."
) %>%
kable_styling(
position = "center",
latex_options = "scale_down"
)
prod_table
prod_table <-
ses_wg_lm_prod %>%
tidy() %>%
mutate(across(
.cols = 2:7,
.fns = ~ round(., digits = 3)
)) %>%
mutate(term = rownames) %>%
select(-outcome) %>%
kbl(
booktabs = TRUE,
linesep = "",
caption = "Regression output for WG production measure."
) %>%
kable_styling(
position = "center",
latex_options = "scale_down"
)
prod_table
#4-facet plot of WG glm for wordbank and web-cdi
wgglm <-
wg_momed %>%
mutate(measure = fct_relevel(measure, "Words Understood")) %>%
ggplot(aes(age, words, color = maternal_ed)) +
facet_wrap(measure~sample) +
geom_jitter(alpha = 0.15, width = 0.225) +
geom_line(aes(y = fitted), data = wg_momed_fits, size = 1.7, alpha = 0.8) +
coord_cartesian(ylim = c(0, 396)) +
ggthemes::theme_few() +
labs(
x = "Age in months",
y = "Number of words",
color = "Primary caregiver education",
linetype = "Primary caregiver education"
) +
scale_x_continuous(breaks = seq(from = 8, to = 18, by = 2)) +
scale_color_viridis_d(option = "inferno", begin = .3, end = .8) +
theme(
legend.position = "bottom",
axis.title = element_text(size = 20),
axis.text = element_text(size = 17),
legend.title = element_text(size = 20),
legend.text = element_text(size = 17),
strip.text = element_text(size = 17),
panel.spacing.y = unit(2, "lines")
) +
guides(color = guide_legend(title.position = "top"))
ggsave(
"wgglm.png",
plot = wgglm,
path = fig_directory,
width = 13,
height = 10
)
ggsave(
"wgglm.png",
plot = wgglm,
path = fig_directory,
width = 13,
height = 11.5
)
path(fig_directory, "WS_instructions.pdf")
knitr::include_graphics(
path = path(fig_directory, "WS_instructions.pdf")
)
