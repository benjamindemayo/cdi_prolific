---
title: "Full dataset analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(png)
library(knitr)
library(markdown)
library(lmerTest)
library(ggthemes)
library(psych)
library(magrittr)
library(tidyboot)
library(fs)
library(ggmap)
library(lubridate)

source(path(here::here(), "file_paths.R"))
source(functions_script)

#Variables to tinker with
min_completion_time = 8.5
```

First read in all of the relevant data.

```{r message=FALSE}
all_ws_1 <- 
  readInWebCDI(all_data_ws1_path) %>% 
  select( #drop a bunch of columns that were screwing up the merge with prolific data
    -opt_out,
    -country,
    -sibling_boolean,
    -sibling_data,
    -sibling_count,
    -caregiver_other
  )

all_ws_2 <- 
  readInWebCDI(all_data_ws2_path) %>% 
  select( #drop a bunch of columns that were screwing up the merge with prolific data
    -opt_out,
    -country,
    -sibling_boolean,
    -sibling_data,
    -sibling_count,
    -caregiver_other
  )

all_ws_raw <- 
  all_ws_1 %>% 
  bind_rows(all_ws_2) %>% 
  mutate(completed = case_when(
    stringr::str_to_lower(completed) == "true" ~ TRUE,
    stringr::str_to_lower(completed) == "false" ~ FALSE
  ))

all_wg_raw <- readInWebCDI(all_data_wg_path)
```


Filter out: multilingual exposure, illnesses, vision and hearing problems.
```{r}

#WG
wg_filtered <- 
  all_wg_raw %>% 
  filterIllnesses() %>% 
  filterBirthweight() %>% 
  filterMultilingual() %>% 
  filterVision() %>% 
  filterHearing() %>% 
  getEthnicities() %>% 
  getMaternalEd() %>%
  filter_age_wg()

ws_filtered <- 
  all_ws_raw %>% 
  filterIllnesses() %>% 
  filterBirthweight() %>% 
  filterMultilingual() %>% 
  filterVision() %>% 
  filterHearing() %>% 
  getEthnicities() %>% 
  getMaternalEd() %>% 
  filter_age_ws()


```


```{r}
ws_filtered %>% 
  ggplot(aes(age, `Total Produced`, color = maternal_ed)) +
  geom_point() +
  geom_smooth(method = "lm")


```

